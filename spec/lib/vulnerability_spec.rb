require 'spec_helper'

describe WPScan::Vulnerability do
  subject(:vuln)   { described_class.new(title, references) }
  let(:title)      { 'Test Vuln' }
  let(:references) { {} }

  its(:wpvulndb_ids)    { should eql([]) }
  its(:wpvulndb_urls)   { should eql([]) }
  its(:references_urls) { should eql([]) }

  context 'when wpvulndb reference' do
    let(:references) { { wpvulndb: 1 } }

    its(:wpvulndb_ids)    { should eql %w(1) }
    its(:wpvulndb_urls)   { should eql %w(https://wpvulndb.com/vulnerabilities/1) }
    its(:references_urls) { should eql %w(https://wpvulndb.com/vulnerabilities/1) }
  end

  describe '#load_from_json' do
    # Handled in spec/app/models/wp_version_spec#vulnerabilities
  end
end
